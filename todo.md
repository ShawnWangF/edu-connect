# Education Connect 項目待辦清單

## 數據庫設計
- [x] 設計並實現用戶表（擴展權限字段）
- [x] 設計並實現團組表
- [x] 設計並實現行程表
- [x] 設計並實現人員表
- [x] 設計並實現資源表（景點、酒店、車輛、導遊）
- [x] 設計並實現快照表（版本控制）
- [x] 設計並實現文件表（文檔存儲）
- [x] 創建初始管理員賬號 wang/000000

## 用戶認證和權限系統
- [x] 實現用戶登錄功能
- [x] 實現三級權限體系（管理員/編輯者/查看者）
- [x] 實現權限檢查中間件
- [x] 實現用戶管理頁面（僅管理員可訪問）
- [x] 實現用戶列表展示
- [x] 實現新建用戶功能
- [x] 實現編輯用戶功能
- [x] 實現刪除用戶功能

## 團組管理核心功能
- [x] 實現團組列表頁面
- [x] 實現團組搜索和篩選功能
- [x] 實現新增團組功能
- [x] 實現編輯團組功能
- [x] 實現刪除團組功能
- [ ] 實現批量創建團組功能
- [x] 實現團組基本信息表單（名稱、日期、人數、類型、狀態等）
- [x] 實現團組詳情頁面（多標籤頁設計）

## 行程詳情管理
- [x] 實現行程時間軸展示
- [x] 實現添加行程點功能
- [x] 實現編輯行程點功能
- [x] 實現刪除行程點功能
- [ ] 實現導出 DOCX 格式功能
- [ ] 實現導出 MD 格式功能
- [ ] 實現導出 TXT 格式功能

## 食行卡片功能
- [x] 實現每日卡片佈局
- [x] 實現交通安排模塊
- [x] 實現天氣信息模塊
- [x] 實現住宿信息模塊
- [x] 實現車輛安排模塊
- [x] 實現導遊安排模塊
- [x] 實現安保安排模塊
- [x] 實現三餐安排模塊
- [x] 實現特殊備註模塊
- [x] 實現複製上一日安排功能

## 日曆視圖
- [x] 實現日曆時間表佈局
- [x] 實現按小時劃分時間格
- [x] 實現彩色方塊顯示活動
- [ ] 實現拖拽調整行程功能
- [ ] 實現右側任務列表面板

## 人員信息管理
- [x] 實現人員列表展示
- [x] 實現添加人員功能
- [x] 實現編輯人員功能
- [x] 實現刪除人員功能
- [x] 實現批量導入人員功能
- [x] 實現人員信息表單（姓名、身份、性別、聯系電話、備註）

## 行程設計器
- [x] 實現週視圖控制台
- [x] 實現時段劃分（上午/下午/晚上）
- [ ] 實現拖拽行程功能
- [x] 實現日期導航功能
- [ ] 實現導入功能
- [ ] 實現導出功能
- [x] 實現每日關注事項顯示
- [x] 實現多團組統籌視圖

## 資源管理系統
- [x] 實現行程點資源管理頁面
- [x] 實現景點信息管理（地址、容量、適用團組、受限日期）
- [ ] 實現行程方案模板管理
- [ ] 實現人員資源管理
- [ ] 實現住宿資源管理
- [ ] 實現車輛資源管理
- [x] 實現資源搜索功能
- [x] 實現資源添加/編輯/禁用功能

## 統計報表功能
- [x] 實現數據概覽儀表板
- [x] 實現團組總數統計
- [x] 實現參訪地點統計
- [x] 實現活動總數統計
- [x] 實現地點使用統計表格
- [ ] 實現活動安排導出功能
- [ ] 實現按日期範圍篩選功能
- [ ] 實現容量利用率分析

## 系統設置與版本控制
- [x] 實現系統設置頁面
- [ ] 實現行程設計器全局配置
- [x] 實現手動快照功能
- [ ] 實現自動快照功能（每6小時）
- [x] 實現版本歷史記錄列表
- [ ] 實現一鍵恢復功能
- [x] 實現快照令牌複製功能

## 通知和提醒功能
- [x] 實現重要事項提醒功能
- [x] 實現截止日期通知功能
- [x] 實現團組出發前自動提醒
- [x] 實現行程變更通知功能

## 文件管理功能
- [x] 實現文件上傳功能
- [x] 實現文件列表展示
- [x] 實現文件預覽功能
- [x] 實現文件下載功能
- [x] 實現文件刪除功能

## UI/UX 優化
- [x] 設計整體色彩方案
- [x] 設計導航系統（側邊欄）
- [ ] 設計響應式佈局
- [ ] 實現加載狀態動畫
- [ ] 實現錯誤提示組件
- [ ] 實現成功提示組件
- [ ] 優化表單交互體驗
- [ ] 優化表格展示效果

## 測試和部署
- [x] 編寫單元測試
- [x] 進行功能測試
- [x] 進行權限測試
- [x] 創建項目檢查點
- [ ] 準備部署文檔

## Bug 修復
- [x] 修復首頁中 /settings/snapshots 路由錯誤（應為 /settings）
- [x] 修復登錄成功後無法進入主界面的問題
- [x] 添加 /planner 行程設計器路由
- [x] 檢查並修復所有缺失的路由

## 功能完善
- [x] 完善食行卡片編輯功能（交通、餐飲、住宿、車輛、導遊、安保等）
- [x] 實現人員信息的增刪改查功能
- [x] 實現批量導入人員功能
- [x] 實現文件管理功能（上傳、下載、預覽、刪除）
- [x] 為團組添加文件附件功能
- [x] 編寫功能測試（食行卡片、人員管理、文件管理）

## UI 優化
- [x] 優化食行卡片的UI設計，使用圖標和更好的布局
- [x] 改進信息分組和視覺層次
- [x] 添加更多視覺元素提升用戶體驗

## 關鍵功能開發（本次迭代）
- [x] 實現編輯團組功能
- [x] 實現刪除團組功能
- [x] 實現行程點的添加/編輯/刪除功能
- [x] 實現行程時間軸展示
- [x] 實現複製上一日食行卡片功能
- [x] 實現批量導入人員功能（Excel）
- [x] 編寫關鍵功能測試（團組編輯/刪除、行程點管理、食行卡片）

## Excel批量導入人員功能
- [x] 安裝Excel解析庫（xlsx）
- [x] 實現後端批量創建人員APIPI
- [x] 在人員信息標籤頁添加「批量導入」按鈕
- [x] 實現Excel文件上傳和解析功能
- [x] 實現導入預覽界面，高亮顯示空值字段
- [x] 實現批量導入確認和執行功能
- [x] 編寫批量導入功能測試

## 修改批量導入功能 - 支持任意字段
- [x] 修改數據庫schema，添加customFields JSON字段支持自定義字段
- [x] 修改後端API，支持接收任意字段的JSON對象
- [x] 修改前端Excel解析邏輯，移除字段映射，直接使用表頭作為字段名
- [x] 修改預覽界面，動態顯示所有字段
- [x] 測試任意字段導入功能

## Bug 修復 - 批量導入按鈕
- [x] 檢查批量導入預覽對話框的按鈕代碼
- [x] 修復確認導入按鈕顯示問題
- [x] 測試批量導入完整流程

## Bug 修復 - 批量導入後成員列表不刷新
- [x] 檢查批量導入成功後的數據刷新邏輯
- [x] 修復成員列表不刷新的問題
- [x] 在成員列表中顯示自定義字段
- [x] 優化成員列表表格，動態顯示所有字段
- [x] 測試批量導入和顯示功能

## Bug 調試 - 批量導入和顯示問題
- [x] 檢查批量導入API是否真的成功寫入數據庫
- [x] 檢查成員列表查詢是否返回正確數據
- [x] 修復成員列表不顯示已導入數據的問題（使用refetch強制重新獲取）
- [x] 修復預覽對話框空值高亮不顯示的問題（已存在）
- [x] 測試完整的批量導入流程

## 本次迭代 - 完善核心功能模塊
### 食行卡片全部功能
- [x] 優化食行卡片數據結構（已完成）
- [x] 確保所有模塊（交通、天氣、住宿、車輛、導遊、安保、三餐、備註）都可編輯
- [ ] 實現食行卡片打印視圖

### 日曆視圖全部功能
- [x] 創建日曆視圖頁面組件
- [x] 實現日曆網格佈局（按小時劃分）
- [x] 實現行程活動在日曆上的顯示
- [ ] 實現拖曳調整行程時間功能
- [ ] 實現右側任務面板

### 行程設計器全部功能
- [x] 完善Planner頁面的週視圖
- [x] 實現時段劃分顯示（上午/下午/晚上）
- [x] 實現多團組並行展示
- [ ] 實現拖拽分配行程功能
- [x] 實現每日關注事項面板

### 通知和提醒功能
- [x] 設計通知數據結構
- [x] 實現通知API（創建、查詢、標記已讀）
- [x] 實現通知中心UI
- [x] 實現團組出發前自動提醒邏輯
- [x] 實現行程變更通知邏輯

### 文件管理功能完善
- [x] 確認文件上傳功能正常（已實現）
- [x] 優化文件列表展示
- [x] 實現文件預覽功能（圖片、PDF）
- [x] 添加文件分類和標籤

## UI優化 - 行程點添加界面
- [x] 將日期選擇從下拉菜單改為日期選擇器，支持自由選擇任意日期
- [x] 優化表單布局和用戶體驗

## Bug修復 - 行程點數據同步
- [x] 檢查行程設計器的數據加載邏輯
- [x] 檢查日曆視圖的數據加載邏輯
- [x] 修復行程點在三個視圖間的數據同步問題
- [x] 確保添加行程點後所有視圖都能實時更新

## 拖拽功能和時段優化
- [x] 優化行程設計器時段顯示，移除固定時段限制，動態顯示所有時段
- [x] 實現日曆視圖的拖拽調整行程功能
- [x] 實現行程設計器的拖拽行程功能
- [x] 確保拖拽後所有視圖數據同步更新

## 通知系統優化
- [x] 分析當前通知邏輯
- [x] 設計需要通知全體成員的用戶動作清單
- [x] 實現團組創建/編輯通知
- [x] 實現行程變更通知
- [x] 實現重要文件上傳通知
- [x] 實現成員批量導入通知
- [x] 測試通知觸發機制

## Bug修復 - 關鍵問題
- [ ] 修復拖拽功能：實現調整色塊長短來快速排列時間分布
- [x] 修復人員批量導入後無法在團組成員界面顯示的問題
- [x] 實現團組成員批量勾選（全選）刪除功能
- [x] 優化日曆視圖布局，解決過度居中問題
- [x] 在通知中心左側導航欄顯示通知數量
- [x] 在儀表板顯示本週關注事項

## 行程設計器重新設計
- [x] 分析當前實現的問題（時段不完整、拖拽不順暢）
- [x] 重新設計時段顯示，改為完整24小時（00:00-23:00）
- [x] 優化拖拽移動功能，提升流暢度
- [x] 實現拖拽邊緣調整時間長度功能（拖拽頂部/底部邊緣）
- [x] 添加視覺反饋（拖拽時顯示時間、調整時顯示時長）
- [x] 測試所有拖拽場景

## Bug調查 - 批量導入數據不顯示
- [x] 讀取用戶提供的Excel文件並查看數據結構
- [x] 使用API上傳人員清單到第一個團組
- [x] 檢查數據庫確認數據已保存
- [x] 檢查前端顯示邏輯並修復問題
